{% extends "meetLink/base.html" %}

{% block contenido %}

<!-- Botón desplegar menú (pantallas pequeñas) -->
<button class="btn-toggle-menu btn btn-outline-light d-md-none m-2" type="button" onclick="toggleMenu()" aria-controls="navbar">
    ☰
</button>

<!-- Navbar -->
<div id="navbar" class="sidebar offcanvas-md offcanvas-start" tabindex="-1" aria-labelledby="sidebarLabel" style="display: none;">
    <div class="offcanvas-header d-md-none">
        <h5 class="offcanvas-title text-light" id="sidebarLabel">Menú</h5>
        <button type="button" class="btn-close btn-close-white" onclick="toggleMenu()" aria-label="Cerrar">×</button>
    </div>

    <div id="contenido-navbar" class="offcanvas-body d-flex flex-column">
        <div class="user-info text-center mb-4">
            <img src="{{ user.profile.image.url|default:'/media/logo2.png' }}" alt="Foto de perfil">
            <h5 class="mt-2">{{ user.username }}</h5>
        </div>
        <ul class="nav flex-column mb-4">
            <li class="nav-item">
                <a class="nav-link active" href="#">INICIO</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">CONTACTOS</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#">EVENTOS</a>
            </li>
        </ul>
        <form action="{% url 'logout' %}" method="post" class="mt-auto text-center">
            {% csrf_token %}
            <button type="submit" class="btn logout-btn mt-4">Log Out</button>
        </form>
        <div class="navbar-footer">
            meetLink - 2025
        </div>        
    </div>
</div>

<!-- MAIN CONTENT -->
<!-- MAIN CONTENT -->
<main class="content-wrapper">
    <div id="content" class="row flex-column">
        <!-- Parte central -->
        <div id="columna-contenido" class="col-12 mb-4">
            <div id="card-crearEvento" class="card text p-3">
                <h4><strong>¿Algo nuevo?</strong></h4>
                <p>Planifica una nueva actividad o viaje y compártelo con tus contactos.</p>
                <a id="btn-crearEvento" class="btn btn-outline border-dark">CREAR</a>
            </div>
        </div>

        <!-- Columna eventos abajo en línea -->
        <div id="columna-eventos" class="col-12 d-flex flex-wrap gap-3">
            <div class="scroll-events d-flex flex-wrap w-100">
                {% for evento in eventos %}
                    <div class="card event-card p-3" style="flex: 1 1 250px; max-width: 300px;">
                        <h5>{{ evento.nombre }}</h5>
                        <small>{{ evento.fecha|date:"d/m/Y" }}</small>
                        <p>{{ evento.descripcion|truncatewords:15 }}</p>
                        <a href="{% url 'detalle_evento' evento.id %}" class="btn btn-sm btn-outline-light">Ver más</a>
                    </div>
                {% empty %}
                    <p class="text-light">Todavía no hay eventos disponibles.</p>
                {% endfor %}
            </div>
        </div>
    </div>
</main>


<!-- JavaScript para manejar el menú móvil -->
<script>
    function toggleMenu() {
        const navbar = document.getElementById('navbar');
        if (navbar.style.display === 'none' || navbar.style.display === '') {
            navbar.style.display = 'block';
        } else {
            navbar.style.display = 'none';
        }
    }

    // Mostrar automáticamente el menú si pantalla es md o más (simulación de 'offcanvas-md')
    function handleResize() {
        const navbar = document.getElementById('navbar');
        if (window.innerWidth >= 768) {
            navbar.style.display = 'block';
        } else if (!document.querySelector('.btn-toggle-menu').classList.contains('open')) {
            navbar.style.display = 'none';
        }
    }

    window.addEventListener('resize', handleResize);
    window.addEventListener('DOMContentLoaded', handleResize);
</script>

{% endblock %}
